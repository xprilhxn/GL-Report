<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GLAZING LINE APPLICATION REPORT</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 20px;
      background: #f0f2f5;
      color: #333;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
      color: #1a2a44;
      font-weight: 700;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: #ffffff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }

    .header-form {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 25px;
      flex-wrap: wrap;
      background: #f9f9f9;
      padding: 15px;
      border-radius: 8px;
    }
    .header-form label {
      font-weight: 600;
      color: #555;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .header-form input,
    .header-form select {
      padding: 10px 15px;
      min-width: 150px;
      border: 1px solid #ddd;
      border-radius: 6px;
      text-align: center;
      transition: all 0.3s ease;
      font-size: 16px;
    }
    .header-form input:focus,
    .header-form select:focus {
      border-color: #007bff;
      box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
      outline: none;
    }

    /* CSS tambahan untuk meratakan judul dropdown di tengah */
    .title-dropdown-container {
        text-align: center;
        margin-bottom: 25px;
    }
    .title-dropdown-container #report-title-select {
        text-align-last: center;
        -moz-text-align-last: center;
        width: 100%;
        max-width: 500px; /* Batasi lebar agar tidak terlalu besar di layar lebar */
        padding: 0;
    }

    .report-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 25px;
      table-layout: fixed;
      text-align: center;
      background: #fff;
      font-size: 11px;
    }
    .report-table th, .report-table td {
      border: 1px solid #e0e0e0;
      padding: 5px;
      word-wrap: break-word;
    }
    .report-table th {
      background: #f5f7f9;
      font-weight: 600;
      color: #1a2a44;
    }
    .report-table input {
      width: 95%;
      box-sizing: border-box;
      text-align: center;
      border: 1px solid #ddd;
      border-radius: 0px;
      padding: 0px;
      transition: border-color 0.3s;
      font-size: 14px;
    }
    .report-table input:focus {
      border-color: #007bff;
      outline: none;
    }

    .btn-container {
      text-align: center;
      margin: 20px 0;
    }
    .dropbtn, .btn-container button {
      padding: 12px 25px;
      margin: 5px;
      background: #007bff;
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      transition: background 0.3s ease, transform 0.2s ease;
      box-shadow: 0 4px 8px rgba(0, 123, 255, 0.2);
    }
    .dropbtn:hover, .btn-container button:hover {
      background: #0056b3;
      transform: translateY(-2px);
    }
    .dropbtn:active, .btn-container button:active {
      transform: translateY(0);
    }
    .btn-container button:disabled {
        background: #ccc;
        cursor: not-allowed;
    }
    
    /* Reset Button */
    #resetBtn {
      background: #dc3545;
    }
    #resetBtn:hover {
      background: #c82333;
    }

    /* Dropdown CSS */
    .dropdown {
        position: relative;
        display: inline-block;
    }
    .dropdown-content {
        display: none;
        position: absolute;
        background-color: #f9f9f9;
        min-width: 250px;
        box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
        z-index: 1;
        border-radius: 8px;
        margin-top: 5px;
        right: 0;
    }
    .dropdown-content a {
        color: black;
        padding: 12px 16px;
        text-decoration: none;
        display: block;
        font-size: 14px;
        border-bottom: 1px solid #eee;
    }
    .dropdown-content a:last-child {
        border-bottom: none;
    }
    .dropdown-content a:hover {
        background-color: #f1f1f1;
    }
    .show {
        display: block;
    }
    .dropdown-content .delete-link {
        color: #dc3545;
        font-weight: 600;
        cursor: pointer;
    }
    .dropdown-content a.disabled {
      color: #aaa;
      pointer-events: none;
    }

    /* Watermark Container CSS */
    #watermark-container {
        position: relative;
        height: 20px;
        margin-top: -15px;
        text-align: center;
    }
    .watermark {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: rgba(0, 0, 0, 0.5);
        font-size: 10px;
        font-family: 'Poppins', sans-serif;
        white-space: nowrap;
        pointer-events: none;
        user-select: none;
        z-index: 1000;
    }

    .results {
      background: #f9f9f9;
      border: 1px solid #e0e0e0;
      padding: 20px;
      margin-top: 25px;
      border-radius: 8px;
    }
    .results h2 {
      text-align: center;
      margin-bottom: 15px;
      color: #1a2a44;
      font-weight: 600;
    }
    .results table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    .results th, .results td {
      border: 1px solid #e0e0e0;
      padding: 10px;
      text-align: center;
    }
    .results th {
      background: #f5f7f9;
      color: #1a2a44;
      font-weight: 600;
    }
    .chart-container {
      position: relative;
      height: 400px;
      width: 100%;
      margin-top: 20px;
      background-color: #fff;
      padding: 15px;
      border-radius: 8px;
    }

    #desktop-content {
      display: block;
    }

    #mobile-warning {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #fff;
      color: #000;
      font-size: 18px;
      text-align: center;
      padding: 50px 20px;
      z-index: 9999;
    }

    @media (max-width: 768px) {
      .report-table { font-size: 12px; }
      .results { font-size: 12px; }
      .container { padding: 15px; }
      .header-form { flex-direction: column; align-items: stretch; gap: 10px; }
      .header-form label { justify-content: space-between; }
      #desktop-content {
        display: none;
      }
      #mobile-warning {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }
    }
  </style>
</head>
<body>
  <div id="desktop-content">
    <div class="container">
      <div id="printable-area">
        <div class="title-dropdown-container">
          <label for="report-title-select">
            <select id="report-title-select" style="font-size: 24px; font-weight: 700; border: none; background: transparent; text-align: center; color: #1a2a44;">
              <option value="TOP GLAZE APPLICATION REPORT">TOP GLAZE APPLICATION REPORT</option>
              <option value="ENGOBE APPLICATION REPORT">ENGOBE APPLICATION REPORT</option>
            </select>
          </label>
        </div>
  
        <div class="header-form">
          <label for="tanggal">Date:
            <input type="date" id="tanggal">
          </label>
  
          <label for="grup">Group:
            <select id="grup">
              <option value="A">A</option>
              <option value="B">B</option>
              <option value="C">C</option>
            </select>
          </label>
  
          <label for="shift">Shift:
            <select id="shift">
              <option value="1">Shift 1</option>
              <option value="2">Shift 2</option>
            </select>
          </label>
        </div>
  
        <div id="report-content">
          <table class="report-table">
            <thead>
              <tr>
                <th rowspan="2">Jam</th>
                <th colspan="3">Line 2A</th>
                <th colspan="4">Weight Gram (g)</th>
                <th colspan="3">Line 2B</th>
                <th colspan="4">Weight Gram (g)</th>
              </tr>
              <tr>
                <th>Water (g)</th>
                <th>Density (g)</th>
                <th>Viscosity (s)</th>
                <th>Luar</th>
                <th>Tengah</th>
                <th>Dalam</th>
                <th>Avg/jam</th>
                <th>Water (g)</th>
                <th>Density (g)</th>
                <th>Viscosity (s)</th>
                <th>Luar</th>
                <th>Tengah</th>
                <th>Dalam</th>
                <th>Avg/jam</th>
              </tr>
            </thead>
            <tbody id="table-body"></tbody>
          </table>
        </div>
        
        <div id="watermark-container">
          <div class="watermark" id="report-watermark"></div>
        </div>
  
        <div class="results" id="results">
          <h2>12-HOUR AVERAGE CALCULATION RESULTS</h2>
          <table id="result-table">
            <thead>
              <tr>
                <th>Parameter</th>
                <th>Line 2A</th>
                <th>Line 2B</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Water (g)</td>
                <td id="avgWater2A">-</td>
                <td id="avgWater2B">-</td>
              </tr>
              <tr>
                <td>Density (g)</td>
                <td id="avgDensity2A">-</td>
                <td id="avgDensity2B">-</td>
              </tr>
              <tr>
                <td>Viscosity (s)</td>
                <td id="avgViscosity2A">-</td>
                <td id="avgViscosity2B">-</td>
              </tr>
              <tr>
                <td>Weight Luar (g)</td>
                <td id="avgLuar2A">-</td>
                <td id="avgLuar2B">-</td>
              </tr>
              <tr>
                <td>Weight Tengah (g)</td>
                <td id="avgTengah2A">-</td>
                <td id="avgTengah2B">-</td>
              </tr>
              <tr>
                <td>Weight Dalam (g)</td>
                <td id="avgDalam2A">-</td>
                <td id="avgDalam2B">-</td>
              </tr>
              <tr>
                <td>Total Weight (g)</td>
                <td id="avgTotal2A">-</td>
                <td id="avgTotal2B">-</td>
              </tr>
            </tbody>
          </table>

          <div class="chart-container">
              <canvas id="myChart"></canvas>
          </div>
        </div>
      </div>
  
      <div class="btn-container">
        <button onclick="calculate()" id="calculateBtn">CALCULATE AVERAGE</button>
        <button id="saveBtn" onclick="saveReport()">SAVE REPORT</button>
        <div class="dropdown">
            <button class="dropbtn" onclick="toggleDropdown()">PRINT REPORT</button>
            <div id="printOptions" class="dropdown-content">
                <a href="#" onclick="downloadPNG()">PNG</a>
                <a href="#" onclick="downloadPDF()">PDF</a>
            </div>
        </div>
        <div class="dropdown">
            <button class="dropbtn" onclick="toggleLoadDropdown()">LOAD REPORT</button>
            <div id="loadOptions" class="dropdown-content"></div>
        </div>
        <button id="resetBtn" onclick="resetData()">RESET</button>
      </div>
    </div>
  </div>

  <div id="mobile-warning">
    <p>Maaf, website ini hanya bisa diakses dalam mode desktop.</p>
    <p>Silakan gunakan desktop/laptop atau aktifkan "Situs Desktop" pada browser Anda.</p>
  </div>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const tableBody = document.getElementById("table-body");

    // buat 12 baris jam default
    for (let i = 1; i <= 12; i++) {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td class="jam-cell">Jam ${i}</td>
        <td><input type="number" id="water2A-${i}" min="0"></td>
        <td><input type="number" id="density2A-${i}" min="0"></td>
        <td><input type="number" id="viscosity2A-${i}" min="0"></td>
        <td><input type="number" id="luar2A-${i}" min="0" oninput="liveCalculate(${i}, '2A')"></td>
        <td><input type="number" id="tengah2A-${i}" min="0" oninput="liveCalculate(${i}, '2A')"></td>
        <td><input type="number" id="dalam2A-${i}" min="0" oninput="liveCalculate(${i}, '2A')"></td>
        <td id="avg2A-${i}">-</td>
        <td><input type="number" id="water2B-${i}" min="0"></td>
        <td><input type="number" id="density2B-${i}" min="0"></td>
        <td><input type="number" id="viscosity2B-${i}" min="0"></td>
        <td><input type="number" id="luar2B-${i}" min="0" oninput="liveCalculate(${i}, '2B')"></td>
        <td><input type="number" id="tengah2B-${i}" min="0" oninput="liveCalculate(${i}, '2B')"></td>
        <td><input type="number" id="dalam2B-${i}" min="0" oninput="liveCalculate(${i}, '2B')"></td>
        <td id="avg2B-${i}">-</td>
      `;
      tableBody.appendChild(row);
    }
    
    // Fungsi untuk perhitungan langsung
    function liveCalculate(rowId, line) {
        const luar = parseFloat(document.getElementById(`luar${line}-${rowId}`).value) || 0;
        const tengah = parseFloat(document.getElementById(`tengah${line}-${rowId}`).value) || 0;
        const dalam = parseFloat(document.getElementById(`dalam${line}-${rowId}`).value) || 0;
        const avgCell = document.getElementById(`avg${line}-${rowId}`);
        
        if (luar > 0 || tengah > 0 || dalam > 0) {
            const avg = (luar + tengah + dalam) / 3;
            avgCell.textContent = avg.toFixed(2);
        } else {
            avgCell.textContent = "-";
        }
    }

    // fungsi update jam sesuai shift
    function updateJam() {
      const shift = document.getElementById("shift").value;
      const jamCells = document.querySelectorAll("#table-body .jam-cell");

      let startHour = shift === "1" ? 7 : 19;

      for (let i = 0; i < 12; i++) {
        let hour = (startHour + i) % 24;
        let labelJam = (hour < 10 ? "0" + hour : hour) + ".00";
        jamCells[i].textContent = labelJam;
      }
    }

    document.getElementById("shift").addEventListener("change", updateJam);

    // jalankan sekali saat awal
    updateJam();

    // hitung rata-rata
    function calculate() {
        const calculateBtn = document.getElementById('calculateBtn');
        const originalText = calculateBtn.textContent;
        calculateBtn.textContent = 'Menghitung...';
        calculateBtn.disabled = true;

        setTimeout(() => {
            const lines = ["2A", "2B"];
            lines.forEach(line => {
                let totalWater = 0, totalDensity = 0, totalViscosity = 0;
                let totalLuar = 0, totalTengah = 0, totalDalam = 0, count = 0;
    
                for (let i = 1; i <= 12; i++) {
                    const water = parseFloat(document.getElementById(`water${line}-${i}`).value) || 0;
                    const density = parseFloat(document.getElementById(`density${line}-${i}`).value) || 0;
                    const viscosity = parseFloat(document.getElementById(`viscosity${line}-${i}`).value) || 0;
                    const luar = parseFloat(document.getElementById(`luar${line}-${i}`).value) || 0;
                    const tengah = parseFloat(document.getElementById(`tengah${line}-${i}`).value) || 0;
                    const dalam = parseFloat(document.getElementById(`dalam${line}-${i}`).value) || 0;
                    
                    const avg = (luar + tengah + dalam) / 3 || 0;
                    document.getElementById(`avg${line}-${i}`).textContent = avg.toFixed(2);
                    
                    if (water || density || viscosity || luar || tengah || dalam) {
                        totalWater += water;
                        totalDensity += density;
                        totalViscosity += viscosity;
                        totalLuar += luar;
                        totalTengah += tengah;
                        totalDalam += dalam;
                        count++;
                    }
                }
    
                document.getElementById(`avgWater${line}`).textContent = count ? (totalWater / count).toFixed(2) : "-";
                document.getElementById(`avgDensity${line}`).textContent = count ? (totalDensity / count).toFixed(2) : "-";
                document.getElementById(`avgViscosity${line}`).textContent = count ? (totalViscosity / count).toFixed(2) : "-";
                document.getElementById(`avgLuar${line}`).textContent = count ? (totalLuar / count).toFixed(2) : "-";
                document.getElementById(`avgTengah${line}`).textContent = count ? (totalTengah / count).toFixed(2) : "-";
                document.getElementById(`avgDalam${line}`).textContent = count ? (totalDalam / count).toFixed(2) : "-";
                document.getElementById(`avgTotal${line}`).textContent = count ? ((totalLuar + totalTengah + totalDalam) / (3 * count)).toFixed(2) : "-";
            });
            createChart();

            calculateBtn.textContent = originalText;
            calculateBtn.disabled = false;
        }, 500); // Penundaan 0.5 detik untuk efek visual
    }

    // Fungsi untuk mereset data
    function resetData() {
        // Reset input fields
        const inputFields = document.querySelectorAll('#table-body input[type="number"]');
        inputFields.forEach(input => {
            input.value = '';
        });

        // Reset avg cells
        const avgCells = document.querySelectorAll('#table-body td[id^="avg"]');
        avgCells.forEach(cell => {
            cell.textContent = '-';
        });

        // Reset summary table
        const summaryCells = document.querySelectorAll('#result-table td[id^="avg"]');
        summaryCells.forEach(cell => {
            cell.textContent = '-';
        });
        
        // Reset chart
        createChart();
    }
    
    // Fungsi untuk menampilkan/menyembunyikan dropdown
    function toggleDropdown() {
        document.getElementById("printOptions").classList.toggle("show");
    }

    // --- FUNGSI UNTUK MANAJEMEN DATA ---
    function saveReport() {
        const tanggal = document.getElementById("tanggal").value;
        const grup = document.getElementById("grup").value;
        const shift = document.getElementById("shift").value;
        const judul = document.getElementById("report-title-select").value; // Mengambil nilai dari dropdown judul

        if (!tanggal) {
            alert("Tanggal harus diisi sebelum menyimpan laporan.");
            return;
        }

        const reportData = {
            judul: judul,
            tanggal: tanggal,
            grup: grup,
            shift: shift,
            tableData: [],
            resultsData: {}
        };

        const inputFields = document.querySelectorAll('#table-body input');
        inputFields.forEach(input => {
            reportData.tableData.push({
                id: input.id,
                value: input.value
            });
        });

        const resultCells = document.querySelectorAll('#result-table td[id^="avg"]');
        resultCells.forEach(cell => {
            reportData.resultsData[cell.id] = cell.textContent;
        });

        const key = `glaze_report_${tanggal}_${grup}_shift${shift}_${judul.replace(/\s/g, '-')}`;
        localStorage.setItem(key, JSON.stringify(reportData));
        alert(`Laporan ${judul} untuk tanggal ${tanggal}, Grup ${grup}, Shift ${shift} berhasil disimpan!`);

        populateLoadDropdown();
    }

    function loadReport(key) {
        const storedData = localStorage.getItem(key);
        if (!storedData) {
            alert("Laporan tidak ditemukan!");
            return;
        }

        const reportData = JSON.parse(storedData);

        document.getElementById("report-title-select").value = reportData.judul; // Memuat nilai judul
        document.getElementById("tanggal").value = reportData.tanggal;
        document.getElementById("grup").value = reportData.grup;
        document.getElementById("shift").value = reportData.shift;
        updateJam();

        reportData.tableData.forEach(item => {
            const input = document.getElementById(item.id);
            if (input) {
                input.value = item.value;
            }
        });

        for (const id in reportData.resultsData) {
            const cell = document.getElementById(id);
            if (cell) {
                cell.textContent = reportData.resultsData[id];
            }
        }
        
        calculate();
        alert("Laporan berhasil dimuat!");
    }

    function deleteReport(key) {
        if (confirm("Apakah Anda yakin ingin menghapus laporan ini?")) {
            localStorage.removeItem(key);
            alert("Laporan berhasil dihapus!");
            populateLoadDropdown();
        }
    }

    function populateLoadDropdown() {
        const dropdown = document.getElementById("loadOptions");
        dropdown.innerHTML = '';

        const reportKeys = Object.keys(localStorage).filter(key => key.startsWith('glaze_report_'));

        if (reportKeys.length === 0) {
            dropdown.innerHTML = '<a href="#" class="disabled">Tidak ada laporan tersimpan</a>';
            return;
        }

        reportKeys.forEach(key => {
            const storedData = localStorage.getItem(key);
            const reportData = JSON.parse(storedData);
            const optionText = `${reportData.tanggal} | ${reportData.grup} | Shift ${reportData.shift} | ${reportData.judul}`;
            
            const loadLink = document.createElement("a");
            loadLink.href = "#";
            loadLink.textContent = optionText;
            loadLink.onclick = (e) => {
                e.preventDefault();
                loadReport(key);
                toggleLoadDropdown();
            };
            
            const deleteLink = document.createElement("a");
            deleteLink.href = "#";
            deleteLink.textContent = ' Hapus';
            deleteLink.className = "delete-link";
            deleteLink.onclick = (e) => {
                e.preventDefault();
                e.stopPropagation();
                deleteReport(key);
                toggleLoadDropdown();
            };
            
            loadLink.appendChild(deleteLink);
            dropdown.appendChild(loadLink);
        });
    }

    function toggleLoadDropdown() {
        document.getElementById("loadOptions").classList.toggle("show");
    }
    
    // Tutup dropdown jika user klik di luar menu
    window.onclick = function(event) {
        if (!event.target.matches('.dropbtn')) {
            const dropdowns = document.getElementsByClassName("dropdown-content");
            for (let i = 0; i < dropdowns.length; i++) {
                const openDropdown = dropdowns[i];
                if (openDropdown.classList.contains('show')) {
                    openDropdown.classList.remove('show');
                }
            }
        }
    }

    // Fungsi untuk menambahkan watermark
    function addWatermark() {
        const watermarkDiv = document.getElementById("report-watermark");
        const now = new Date();
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit' };
        const dateTimeString = now.toLocaleDateString('id-ID', options);
        watermarkDiv.textContent = `${dateTimeString} | Â©https://xprilhxn.github.io/GL-Report/ ${now.getFullYear()}`;
    }

    // download png
    function downloadPNG() {
      const content = document.getElementById("printable-area"); 
      addWatermark();

      html2canvas(content, { scale: 2 }).then(canvas => {
        const link = document.createElement("a");
        link.download = "AprilhxnProject-GL-Report.png";
        link.href = canvas.toDataURL("image/png");
        link.click();
      });
      document.getElementById("printOptions").classList.remove("show");
    }

    // download pdf
    function downloadPDF() {
      const { jsPDF } = window.jspdf;
      const content = document.getElementById("printable-area");
      addWatermark();

      html2canvas(content, { 
        scale: 2,
        windowWidth: content.scrollWidth,
        windowHeight: content.scrollHeight
      }).then(canvas => {
        const imgData = canvas.toDataURL('image/jpeg', 1.0);
        const pdf = new jsPDF('p', 'mm', 'a4');
        const imgWidth = pdf.internal.pageSize.getWidth();
        const pageHeight = pdf.internal.pageSize.getHeight();
        const imgHeight = canvas.height * imgWidth / canvas.width;
        let heightLeft = imgHeight;
        let position = 0;

        pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
        heightLeft -= pageHeight;

        while (heightLeft > 0) {
            position = heightLeft * -1;
            pdf.addPage();
            pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
            heightLeft -= pageHeight;
        }

        pdf.save("laporan-glazure.pdf");
      });
      document.getElementById("printOptions").classList.remove("show");
    }

    let myChart; // Variabel global untuk menyimpan instance grafik

    function createChart() {
      const labels = ["Water (g)", "Density (g)", "Viscosity (s)", "Weight Luar (g)", "Weight Tengah (g)", "Weight Dalam (g)", "Total Weight (g)"];
      
      const data2A = [
          parseFloat(document.getElementById('avgWater2A').textContent),
          parseFloat(document.getElementById('avgDensity2A').textContent),
          parseFloat(document.getElementById('avgViscosity2A').textContent),
          parseFloat(document.getElementById('avgLuar2A').textContent),
          parseFloat(document.getElementById('avgTengah2A').textContent),
          parseFloat(document.getElementById('avgDalam2A').textContent),
          parseFloat(document.getElementById('avgTotal2A').textContent),
      ].map(val => isNaN(val) ? 0 : val);

      const data2B = [
          parseFloat(document.getElementById('avgWater2B').textContent),
          parseFloat(document.getElementById('avgDensity2B').textContent),
          parseFloat(document.getElementById('avgViscosity2B').textContent),
          parseFloat(document.getElementById('avgLuar2B').textContent),
          parseFloat(document.getElementById('avgTengah2B').textContent),
          parseFloat(document.getElementById('avgDalam2B').textContent),
      ].map(val => isNaN(val) ? 0 : val);
      
      const ctx = document.getElementById('myChart').getContext('2d');
      
      if (myChart) {
        myChart.destroy();
      }

      myChart = new Chart(ctx, {
          type: 'bar',
          data: {
              labels: labels,
              datasets: [{
                  label: 'Line 2A',
                  data: data2A,
                  backgroundColor: 'rgba(54, 162, 235, 0.6)',
                  borderColor: 'rgba(54, 162, 235, 1)',
                  borderWidth: 1
              }, {
                  label: 'Line 2B',
                  data: data2B,
                  backgroundColor: 'rgba(255, 99, 132, 0.6)',
                  borderColor: 'rgba(255, 99, 132, 1)',
                  borderWidth: 1
              }]
          },
          options: {
              responsive: true,
              maintainAspectRatio: false,
              scales: {
                  y: {
                      beginAtZero: true
                  }
              },
              plugins: {
                  title: {
                      display: true,
                      text: 'COMPARISON OF AVERAGE PARAMETERS',
                      font: {
                        size: 16,
                        weight: 'bold'
                      }
                  }
              }
          }
      });
    }

    // Panggil fungsi createChart() saat halaman dimuat
    window.addEventListener('load', createChart);
    document.addEventListener('DOMContentLoaded', populateLoadDropdown);
  </script>
</body>
</html>
